<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ubicación en Tiempo Real</title>
    <link rel="stylesheet" href="assets/css/style.css">

    <!-- Incluir el script de Google Maps API de manera eficiente -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDt2G5HPANRdS6FRi-0jdlikDeG11Vw5RU&callback=initMap" 
            async defer></script>

    <script>
        let map;
        let directionsService;
        let directionsRenderer;

        function initMap() {
            // Crear el mapa centrado en un punto medio de los barrios (Santa Cruz de la Sierra)
            const initialLocation = { lat: -17.7850, lng: -63.1737 }; // Coordenadas aproximadas del centro

            map = new google.maps.Map(document.getElementById("mapa-ubicacion"), {
                zoom: 13,
                center: initialLocation
            });

            // Crear el servicio de direcciones
            directionsService = new google.maps.DirectionsService();
            directionsRenderer = new google.maps.DirectionsRenderer();
            directionsRenderer.setMap(map);

            // Coordenadas de la ruta
            const start = { lat: -17.770539633794648, lng: -63.20992613361338 }; // Inicio
            const middle1 = { lat: -17.772068557215775, lng: -63.20394188927357 }; // Intermedio 1
            const middle2 = { lat: -17.777305289438623, lng: -63.205537769465565 }; // Intermedio 2
            const end = { lat: -17.777448567255117, lng: -63.21572145849559 }; // Final

            // Solicitar la ruta
            const request = {
                origin: start,
                destination: end,
                waypoints: [
                    {
                        location: middle1,
                        stopover: true
                    },
                    {
                        location: middle2,
                        stopover: true
                    }
                ],
                travelMode: google.maps.TravelMode.DRIVING
            };

            // Mostrar la ruta en el mapa
            directionsService.route(request, function(result, status) {
                if (status === google.maps.DirectionsStatus.OK) {
                    directionsRenderer.setDirections(result);
                } else {
                    alert('No se pudo trazar la ruta');
                }
            });
        }
    </script>
</head>

<body>
    <!-- Encabezado con navegación -->
    <header>
        <nav>
            <ul>
                <li><a href="index.html">Inicio</a></li>
                <li><a href="registro.html">Registro</a></li>
                <li><a href="calendario.html">Calendario</a></li>
                <li><a href="noticias.html">Noticias</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="welcome-section">
            <h2>Ubicación en Tiempo Real</h2>
            <p>Visualiza la ubicación en tiempo real de los camiones de recolección de basura en los barrios de Santa Cruz de la Sierra: Los Chinos, La Costanera y La Busch.</p>

            <!-- Aquí se cargará el mapa -->
            <div id="mapa-ubicacion" style="width: 100%; height: 400px; border-radius: 8px;"></div>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 Proyecto Basurero. Todos los derechos reservados.</p>
        </div>
    </footer>
</body>

</html>